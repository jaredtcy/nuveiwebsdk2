<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Nuvei WebSDK 2.0 â€“ Test</title>
  <script src="https://cdn.safecharge.com/safecharge_resources/v1/websdk/websdk2.0.js"></script>
  <style>
    .input { border:1px solid #ccc; padding:6px; min-height:32px; margin:4px 0; }
    label { display:block; margin-top:12px; }
    button { margin-top:12px; padding:6px 12px; }
  </style>
</head>
<body>
  <h3>Nuvei WebSDK 2.0 Test</h3>

  <label>Session ID:
    <input id="sessionId" placeholder="paste sessionId">
  </label>

  <label>Cardholder Name:
    <input id="holder" value="CL-BRW1">
  </label>

  <div id="number" class="input"></div>
  <div id="exp" class="input"></div>
  <div id="cvc" class="input"></div>

  <button onclick="initSDK()">Init SDK</button>
  <button onclick="pay()">Submit Payment</button>

  <script>
    let sdk;

    function initSDK() {
      const sessionId = document.getElementById('sessionId').value.trim();
      if (!sessionId) return alert('Paste a sessionId first');

      sdk = webSDK({
        env: 'int', // sandbox
        sessionId: sessionId,
        onResult: res => console.log('onResult callback', res)
      });

      const fields = sdk.fields();

      // Attach Fields 2.0
      fields.create('ccNumber').attach('#number');
      fields.create('ccExpiration').attach('#exp'); // must be 'ccExpiration'
      fields.create('ccCvc').attach('#cvc');        // must be 'ccCvc'

      console.log('SDK initialized with session:', sessionId);
    }

    function pay() {
      if (!sdk) return alert('Initialize SDK first');

      sdk.payment({
        paymentOption: {
          card: {
            cardHolderName: document.getElementById('holder').value
          }
        },
        // These keys must match the fields above exactly
        useFields: ['ccNumber', 'ccExpiration', 'ccCvc']
      })
      .then(res => console.log('Payment response', res))
      .catch(err => console.error('Payment error', err));
    }
  </script>
</body>
</html>
